{% extends 'adminbase.html.twig' %}

{% block title %}Dashboard{% endblock %}

{% block body %}
<!-- BEGIN: Subheader -->
    <div class="m-subheader ">
        <div class="d-flex align-items-center">
            <div class="mr-auto">
                <h3 class="m-subheader__title m-subheader__title--separator">Dashboard</h3>
                <ul class="m-subheader__breadcrumbs m-nav m-nav--inline">
                    <li class="m-nav__item m-nav__item--home">
                        <a href="#" class="m-nav__link m-nav__link--icon">
                            <i class="m-nav__link-icon la la-home"></i>
                        </a>
                    </li>
                    <li class="m-nav__separator">-</li>
                    <li class="m-nav__item">
                        <a href="#" class="m-nav__link">
                            <span class="m-nav__link-text">Dashboard</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </div>
    <div class="m-content">
         <div class="m-portlet">
            <div class="m-portlet__head">
                <div class="m-portlet__head-caption">
                    <div class="m-portlet__head-title">
                        <h3 class="m-portlet__head-text">
                            Insights
                        </h3>
                        
                    </div>
                </div>
                
            </div>
            <div class="m-portlet__body">
            <div class="row d-flex justify-content-center my-2">
                                <div class="col-sm-4">
                                    <div class="card widget-flat">
                                        <div class="card-body">
                                            <div class="float-end">
                                                <i class="mdi mdi-currency-usd widget-icon"></i>
                                            </div>
                                            <h5 class="text-muted fw-normal mt-0" title="Revenue">Revenue</h5>
                                            <h3 class="mt-3 mb-3">XAF {{totalRevenue}}</h3>
                                            <p class="mb-0 text-muted">
                                                <span class="text-danger me-2"><i class="mdi mdi-arrow-down-bold"></i> 7.00%</span>
                                                <span class="text-nowrap">Since last month</span>
                                            </p>
                                        </div> <!-- end card-body-->
                                    </div> <!-- end card-->
                                </div> <!-- end col-->

                                <div class="col-sm-4">
                                    <div class="card widget-flat">
                                        <div class="card-body">
                                            <div class="float-end">
                                                <i class="mdi mdi-currency-usd widget-icon"></i>
                                            </div>
                                            <h5 class="text-muted fw-normal mt-0" title="Potential Revenue">Potential Revenue</h5>
                                            <h3 class="mt-3 mb-3">XAF {{totalPotentialRevenue}}</h3>
                                            <p class="mb-0 text-muted">
                                                <span class="text-danger me-2"><i class="mdi mdi-arrow-down-bold"></i> 7.00%</span>
                                                <span class="text-nowrap">Since last month</span>
                                            </p>
                                        </div> <!-- end card-body-->
                                    </div> <!-- end card-->
                                </div> <!-- end col-->  
                                
                                <div class="col-sm-4">
                                    <div class="card widget-flat">
                                        <div class="card-body">
                                            <div class="float-end">
                                                <i class="mdi mdi-currency-usd widget-icon"></i>
                                            </div>
                                            <h5 class="text-muted fw-normal mt-0" title="Lost Revenue">Lost Revenue</h5>
                                            <h3 class="mt-3 mb-3">XAF {{totalLostRevenue}}</h3>
                                            <p class="mb-0 text-muted">
                                                <span class="text-danger me-2"><i class="mdi mdi-arrow-down-bold"></i> 7.00%</span>
                                                <span class="text-nowrap">Since last month</span>
                                            </p>
                                        </div> <!-- end card-body-->
                                    </div> <!-- end card-->
                                </div> <!-- end col--> 
                </div>
                <div class="row d-flex justify-content-center my-2">
                                <div class="col-sm-4">
                                    <div class="card widget-flat">
                                        <div class="card-body">
                                            <div class="float-end">
                                                <i class="mdi mdi-account-multiple widget-icon"></i>
                                            </div>
                                            <h5 class="text-muted fw-normal mt-0" title="Number of Customers">Customers</h5>
                                            <h3 class="mt-3 mb-3">{{customers}}</h3>
                                            <p class="mb-0 text-muted">
                                                <span class="text-success me-2"><i class="mdi mdi-arrow-up-bold"></i> 5.27%</span>
                                                <span class="text-nowrap">Since last month</span>
                                            </p>
                                        </div> <!-- end card-body-->
                                    </div> <!-- end card-->
                                </div> <!-- end col-->

                                <div class="col-sm-4">
                                    <div class="card widget-flat">
                                        <div class="card-body">
                                            <div class="float-end">
                                                <i class="mdi mdi-cart-plus widget-icon"></i>
                                            </div>
                                            <h5 class="text-muted fw-normal mt-0" title="Number of Orders">Orders</h5>
                                            <h3 class="mt-3 mb-3">{{orders}}</h3>
                                            <p class="mb-0 text-muted">
                                                <span class="text-danger me-2"><i class="mdi mdi-arrow-down-bold"></i> 1.08%</span>
                                                <span class="text-nowrap">Since last month</span>
                                            </p>
                                        </div> <!-- end card-body-->
                                    </div> <!-- end card-->
                                </div> <!-- end col-->

                                <div class="col-sm-3">
                                    <div class="card widget-flat">
                                        <div class="card-body">
                                            <div class="float-end">
                                                <i class="mdi mdi-cart-plus widget-icon"></i>
                                            </div>
                                            <h5 class="text-muted fw-normal mt-0" title="Number of Abandonned Carts">Abandonned Carts</h5>
                                            <h3 class="mt-3 mb-3">{{abandonnedCarts}}</h3>
                                            <p class="mb-0 text-muted">
                                                <span class="text-danger me-2"><i class="mdi mdi-arrow-down-bold"></i> 1.08%</span>
                                                <span class="text-nowrap">Since last month</span>
                                            </p>
                                        </div> <!-- end card-body-->
                                    </div> <!-- end card-->
                                </div>
                </div>
                
                <div class="row">
                    <div class="m-portlet__head">
                        <div class="m-portlet__head-caption">
                            <div class="m-portlet__head-title">
                                <h3 class="m-portlet__head-text">
                                    Revenue Stats
                                </h3>
                        
                                    <form class="d-flex justify-content-end" action="get">
                                        <div class="input-group">
                                            <input type="date" class="form-control" name="date-range">
                                            <button class="btn btn-info">
                                                <i class="la la-calendar font-13"></i>
                                            </button>
                                        </div>
                                    
                                    </form>
                            
                            </div>
                        </div>
                    </div>
                    <canvas class="my-4 w-100 chartjs-render-monitor" id="myChart" width="677" height="285" style="display: block; width: 677px; height: 285px;"></canvas>
                </div>
            </div>
        </div>
    </div>
    <!-- END: Subheader -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.7.1/dist/Chart.min.js"></script>
<script>
      var ctx = document.getElementById("myChart");
      var monthlyRevenue = Object.values(JSON.parse('{{ monthlyRevenue | json_encode() | raw}}'));
      var monthlyPotentialRevenue = Object.values(JSON.parse('{{ monthlyPotentialRevenue | json_encode() | raw}}'));
      var myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Sep", "Oct", "Nov", "Dec"],
          datasets: [{
            data: monthlyPotentialRevenue,
            lineTension: 0,
            backgroundColor: 'transparent',
            borderColor: '#F2587A',
            borderWidth: 4,
            pointBackgroundColor: '#F2587A',
            label: 'Potential Revenue'
          },
          {
            data: monthlyRevenue,
            lineTension: 0,
            backgroundColor: 'transparent',
            borderColor: '#5BD8AA',
            borderWidth: 4,
            pointBackgroundColor: '#5BD8AA',
            label: 'Earned Revenue'
          }]
        },
        options: {
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero: false
              }
            }]
          },
          legend: {
            display: true,
          }
        }
      });
    </script>
{% endblock %}
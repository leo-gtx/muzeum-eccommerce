{% extends 'homebase.html.twig' %}

{% block title %}Orders{% endblock %}

{% block body %}
<!-- Start Banner Area -->
	<section class="banner-area organic-breadcrumb">
		<div class="container">
			<div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
				<div class="col-first">
					<h1>Commande #{{order.id}}</h1>
					<nav class="d-flex align-items-center">
						<a href="{{path('home')}}">Accueil<span class="lnr lnr-arrow-right"></span></a>
						<a href="/orders">Mes commandes<span class="lnr lnr-arrow-right"></span></a>
                        <a href="#">Commande #{{order.id}}</a>
					</nav>
				</div>
			</div>
		</div>
	</section>
	<!-- End Banner Area -->
	{{ include('messages.html.twig') }}
    <!--================Order Details Area =================-->
	<section class="order_details section_gap">
		<div class="container">
			<h3 class="title_confirmation">Merci. Votre commande à bien été reçu.</h3>
			{% if order.isPaid %}
				<div style="height:100px;width:100%;">
						<img src="{{asset('assets/client/img/paid.png')}}" alt="muzeum-logo">
				</div>
			{% else %}
				<div class="my-3 d-flex justify-content-center">
                    <a class="primary-btn" href="{{ order.paymentLink }}">Procéder Au Paiement</a>
                </div>
			{% endif %}
			<div class="row order_d_inner">
				<div class="col-lg-4">
					<div class="details_item">
						<h4>Info de la commande</h4>
						<ul class="list">
							<li><a href="#"><span>Numéro de la commande</span> : #{{order.id}}</a></li>
							<li><a href="#"><span>Date</span> : {{order.createdAt|date('d M Y H:i:s')}}</a></li>
							<li><a href="#"><span>Total</span> : {{order.amount}} XAF</a></li>
                            <li><a href="#"><span>Statut</span> : {{order.status}}</a></li>
							<li><a href="#"><span>Payé</span> : {{order.isPaid ? 'Oui':'En attente du paiement'}}</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-4">
					<div class="details_item">
						<h4>Addresse de facturation</h4>
						<ul class="list">
                            <li><a href="#"><span>Client</span> : {{order.name}}</a></li>
							<li><a href="#"><span>Rue</span> : {{order.shipinfo}}</a></li>
							<li><a href="#"><span>Ville</span> : {{order.city}}</a></li>
							<li><a href="#"><span>Téléphone </span> : {{order.phone}}</a></li>
                            <li><a href="#"><span>Email </span> : {{order.address}}</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-4">
					<div class="details_item">
						<h4>Addresse de livraision</h4>
						<ul class="list">
							<li><a href="#"><span>Client</span> : {{order.name}}</a></li>
							<li><a href="#"><span>Rue</span> : {{order.shipinfo}}</a></li>
							<li><a href="#"><span>Ville</span> : {{order.city}}</a></li>
							<li><a href="#"><span>Téléphone </span> : {{order.phone}}</a></li>
                            <li><a href="#"><span>Email </span> : {{order.address}}</a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="order_details_table">
				<h2>Order Details</h2>
				<div class="table-responsive">
					<table class="table">
						<thead>
							<tr>
								<th scope="col">Produit</th>
								<th scope="col">Quantité</th>
								<th scope="col">Total</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
                        {% for detail in orderDetails %}
							<tr>
								<td>
									<p>{{detail.name}}</p>
								</td>
								<td>
									<h5>x {{detail.quantity}}</h5>
								</td>
								<td>
									<p>{{ detail.price * detail.quantity }} XAF</p>
								</td>
								{% if order.isPaid %}
								<td>
									<!-- Button trigger modal -->
									<button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModal">
									Télécharger
									</button>
								</td>
								{% endif %}
							</tr>
                        {% endfor %}
							<tr>
								<td>
									<h4>Subtotal</h4>
								</td>
								<td>
									<h5></h5>
								</td>
								<td colspan="2">
									<p>XAF {{order.amount}}</p>
								</td>
							</tr>
							<tr>
								<td>
									<h4>Frais de livraison</h4>
								</td>
								<td>
									
								</td>
								<td colspan="2">
									<p>Aux Frais Du Client</p>
								</td>
							</tr>
							
							<tr>
								<td>
									<h4>Total</h4>
								</td>
								<td>
									
								</td>
								<td colspan="2">
									<p>{{order.amount}} XAF</p>
								</td>
							</tr>
							<tr>
							<td></td>
							<td></td>
								<td>
									
								</td>
							</tr>
						</tbody>
					</table>
					{% if not order.isPaid %}
						<div class="checkout_btn_inner d-flex justify-content-center">
							<a class="primary-btn" href="{{ order.paymentLink }}">Procéder Au Paiement</a>
						</div>
					{% endif %}
				</div>
			</div>
		</div>
		<!-- Modal -->
		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Modules Téléchargeables</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
			{% for detail in orderDetails %}
				{% for module in detail.product.modules %}
					<div class="card">
						<div class="filter-bar d-flex flex-wrap align-items-center">
							<div class="sorting">
								<p class="lead text-white">{{ module.title }}</p>
							</div>
						</div>
						<div class="card-body">
							<div class="row">
								<div class="col-sm-12 col-md-1">
									<p class="text-center"><i class="fa fa-hdd-o" style="font-size:40px;"></i></p>
								</div>
								<div class="col-sm-12 col-md-9">
									<p>{{module.description}}</p>
								</div>
								<div class="col-sm-12 col-md-2">
									<a class="btn btn-primary" href="{{path('product_download',{'productId': detail.product.id, 'moduleId': module.id})}}"><i class="fa fa-download"></i></a>
								</div>
							</div>
						</div>
					</div>
				{% endfor %}
			{% endfor %}
			</div>
			{# <div class="modal-footer d-flex justify-content-center align-items-center">
				<button type="button" class="btn primary-btn">Postulez Pour Une Certification</button>
			</div> #}
			</div>
		</div>
		</div>
	</section>
	<!--================End Order Details Area =================-->
    {% endblock %}
